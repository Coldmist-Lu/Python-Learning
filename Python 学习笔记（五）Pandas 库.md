# Python 学习笔记（五）数据分析—— Pandas 库

* 本笔记 # 后为该语句的输出结果，或该变量的值。若 # 后接 ! 号，意思是该语句不能这样写。
* 对于多行的输出结果，我会用""" """进行注释。
* 对于一些输出结果，笔记中为方便理解会在一个代码块写出所有的输出语句，实际调试中应该仅保留一个输出语句（格式化输出print除外），否则前面的输出会被最后一个输出语句覆盖。



* 本笔记的内容主要基于深度之眼的Python基础训练营课程，在顺序和例子上面进行了一些修改和总结。
* 本文对Python的基本语法特性将不做详细回顾，因此对于Python的基本语法的请参看笔记（一）基础编程和笔记（二）高级编程。
* 本笔记主要介绍Python的 Pandas 库。



## 动机

* Numpy 在**向量化的数值计算**中表现优异，但是在处理**更灵活、复杂的数据任务**，如为数据添加标签、处理缺失值、分组和透视表等方面，Numpy 显得力不从心。
*  而基于Numpy构建的Pandas库，提供了使得**数据分析变得更快更简单**的高级数据结构和操作工具。
*  一般 pandas 库的调用方法如下，我们习惯性地将其简写为 pd：

```python
import pandas as pd

...
```



## 构建

### Series 对象

* Series 对象用于存储带标签数据的**一维数组**。

#### 格式

* Series 的创建格式如下：
* **pd.Series(data, index, dtype)**
  * data：数据内容，可以是列表、字典、numpy 数组，甚至可以是标量。
  * index：索引，为可选参数。缺省值在下文具体说明。
  * dtype：数据类型，为可选参数。缺省时根据 data 内容自动设定。

#### data = list

* 若数据为列表，则 series 遵循以下规则：
  * data 必须给出，可包含**多种类型**（符合列表的使用习惯）。
  * index 若不给出，则采用列表各个元素的**索引**作为索引值。
  * dtype 若不给出，则系统根据 data 的类型**自动识别**。
    * 若 data 的列表内元素类型不同，则会按照符合所有类型的数据类型加以填充，如整型和浮点型数据，会使用浮点型；如果是数字和字符串数据，会使用 object 类型等。
    * 若给出 dtype ，系统会对不符合该 dtype 的数据进行**强制类型转换**。如果存在无法强制类型转换的数据，则会**报错**。

* 下面是一些例子：
* 只给列表的情况：

```python
data = pd.Series([1.5, 3, 4.5, 6])
data
"""
0    1.5 # 左列为索引，右列为数据
1    3.0
2    4.5
3    6.0
dtype: float64 # 既有整型，又有浮点型，则自动填充为浮点型
"""
```

* data + index

```python
data = pd.Series([1.5, 3, 4.5, 6], index=["a", "b", "c", "d"])
data
"""
a    1.5 # 左列索引根据index参数修改
b    3.0
c    4.5
d    6.0
dtype: float64
"""
```

* data + index + dtype

```python
data = pd.Series([1, 2, 3, 4], index=["a", "b", "c", "d"], dtype="float")
data
"""
a    1.0 # 数据被强制转换成浮点型
b    2.0
c    3.0
d    4.0
dtype: float64
"""
```

* data 为多种类型：

```python
data = pd.Series([1, 2, "3", 4], index=["a", "b", "c", "d"])
data
"""
a    1
b    2
c    3 # 虽然显示的还是数字，其实是字符串类型
d    4
dtype: object # 数据类型更换成更高的object父类
"""
data['a'] # 1 打印索引'a'对应的数据
data['c'] # '3' 打印索引'c'对应的数据，可以看出是字符串。
```

* 强制类型转换的正确与错误：

```python
data = pd.Series([1, 2, "3", 4], index=["a", "b", "c", "d"], dtype=float)
data['c'] # 3.0  字符串被强制转换成浮点型
# ! data = pd.Series([1, 2, "a", 4], index=["a", "b", "c", "d"], dtype=float) 无法对'a'转换成浮点型
```

#### data = ndarray